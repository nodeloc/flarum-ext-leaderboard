{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@nodeloc/flarum-ext-leaderboard/external assign \"flarum.extensions['ziiven-decoration-store']\"","webpack://@nodeloc/flarum-ext-leaderboard/webpack/bootstrap","webpack://@nodeloc/flarum-ext-leaderboard/webpack/runtime/compat get default export","webpack://@nodeloc/flarum-ext-leaderboard/webpack/runtime/define property getters","webpack://@nodeloc/flarum-ext-leaderboard/webpack/runtime/hasOwnProperty shorthand","webpack://@nodeloc/flarum-ext-leaderboard/webpack/runtime/make namespace object","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/extend']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['forum/app']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/components/UsersSearchSource']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@nodeloc/flarum-ext-leaderboard/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@nodeloc/flarum-ext-leaderboard/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nodeloc/flarum-ext-leaderboard/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/components/Page']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/components/Select']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/components/Button']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/components/SelectDropdown']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/Component']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['helpers/avatar']\"","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['helpers/username']\"","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/components/SmallUserCard.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/components/LeaderBoardUserCard.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/components/LeaderBoardListItem.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/components/LeaderBoardList.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/common/utils/SortMap.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/states/LeaderBoardState.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/components/LeaderBoardPage.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/components/CheckableButton.js","webpack://@nodeloc/flarum-ext-leaderboard/external root \"flarum.core.compat['common/Model']\"","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/models/Text.ts","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/components/index.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/searchTypes/index.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/searchTypes/AbstractType.js","webpack://@nodeloc/flarum-ext-leaderboard/./src/forum/index.js"],"sourcesContent":["module.exports = flarum.extensions['ziiven-decoration-store'];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/UsersSearchSource'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","function _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n    return n;\n  }, _extends.apply(null, arguments);\n}\nexport { _extends as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/listItems'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/SelectDropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserCard'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['helpers/username'];","import ItemList from 'flarum/common/utils/ItemList';\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport app from 'flarum/forum/app';\r\nimport Component from 'flarum/common/Component';\r\nimport avatar from \"flarum/helpers/avatar\";\r\nimport username from \"flarum/helpers/username\";\r\n\r\nexport default class SmallUserCard extends Component {\r\n    /**\r\n     * Allowing to add additonal items unique to the user directory.\r\n     *\r\n     * @return {ItemList<import('mithril').Children>}\r\n     */\r\n    view() {\r\n        const user = this.attrs.user;\r\n        const sort = this.attrs.params.sort|| 'money';\r\n        const userProfileLink = app.route.user(user);\r\n        const points = user.attribute(sort) || '0';\r\n        const position = this.attrs.position;\r\n        let avatarWithFrame, usernameWithColor;\r\n        if('ziiven-decoration-store' in flarum.extensions){\r\n            const { components } = require('@ziiven-decoration-store');\r\n            avatarWithFrame = components.avatarWithFrame;\r\n            usernameWithColor = components.usernameWithColor;\r\n        }        // 根据 position 的值来设置类名\r\n        let positionClass = '';\r\n        if (position === 1) {\r\n            positionClass = 'first';\r\n        } else if (position === 2) {\r\n            positionClass = 'second';\r\n        } else if (position === 3) {\r\n            positionClass = 'third';\r\n        }\r\n        // 根据 sort 字段选择图标\r\n        let iconClass = 'fa-solid fa-chart-simple';\r\n        if (['money', 'lastCheckinMoney'].includes(sort)) {\r\n            iconClass = 'fa-solid fa-bolt';\r\n        } else if (sort === 'bestAnswerCount') {\r\n            iconClass = 'fa-solid fa-check-double';\r\n        } else if (['monthlyDiscussionCount', 'discussionCount'].includes(sort)) {\r\n            iconClass = 'fa-solid fa-pencil';\r\n        } else if (['monthlyCommentCount', 'commentCount'].includes(sort)) {\r\n            iconClass = 'fa-regular fa-comment';\r\n        } else if (['lotteryCount'].includes(sort)) {\r\n            iconClass = 'fa-solid fa-gift';\r\n        }\r\n        return (\r\n            <a href={userProfileLink}>\r\n                                <span className={`LeaderboardListItem-position ${positionClass}`}>\r\n          {position}\r\n        </span>\r\n                {avatarWithFrame?avatarWithFrame(user):avatar(user)}\r\n                <div className=\"LeaderboardListItem-username\">\r\n                    <div>\r\n                        {usernameWithColor?usernameWithColor(user):username(user)}\r\n                    </div>\r\n                </div>\r\n                <span\r\n                    className=\"LeaderboardListItem-count\"\r\n                    title=\"\"\r\n                    aria-label={`${points} Points`}\r\n                    data-original-title={`${points} Points`}\r\n                >\r\n                 {icon(iconClass)}\r\n                    {points}\r\n        </span>\r\n\r\n            </a>\r\n        );\r\n    }\r\n}\r\n","import ItemList from 'flarum/common/utils/ItemList';\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport app from 'flarum/forum/app';\r\nimport Component from 'flarum/common/Component';\r\nimport avatar from \"flarum/helpers/avatar\";\r\nimport username from \"flarum/helpers/username\";\r\n\r\nexport default class LeaderBoardUserCard extends Component {\r\n    /**\r\n     * Allowing to add additonal items unique to the user directory.\r\n     *\r\n     * @return {ItemList<import('mithril').Children>}\r\n     */\r\n    view() {\r\n        const user = this.attrs.user;\r\n        const sort = this.attrs.params.sort || 'money';\r\n        const userProfileLink = app.route.user(user);\r\n\r\n        const points = user.attribute(sort) || '0';\r\n        const position = this.attrs.position;\r\n\r\n        let avatarWithFrame, usernameWithColor;\r\n        if('ziiven-decoration-store' in flarum.extensions){\r\n            const { components } = require('@ziiven-decoration-store');\r\n            avatarWithFrame = components.avatarWithFrame;\r\n            usernameWithColor = components.usernameWithColor;\r\n        }\r\n        // 根据 position 的值来设置类名\r\n        let positionClass = '';\r\n        let displayPosition = position;\r\n        if (position === 1) {\r\n            positionClass = 'second';\r\n            displayPosition = 2;\r\n        } else if (position === 2) {\r\n            positionClass = 'first';\r\n            displayPosition = 1;\r\n        } else if (position === 3) {\r\n            positionClass = 'third';\r\n        }\r\n        // 根据 sort 字段选择图标\r\n        let iconClass = 'fa-solid fa-chart-simple';\r\n        if (['money', 'lastCheckinMoney'].includes(sort)) {\r\n            iconClass = 'fa-solid fa-bolt';\r\n        } else if (sort === 'bestAnswerCount') {\r\n            iconClass = 'fa-solid fa-check-double';\r\n        } else if (['monthlyDiscussionCount', 'discussionCount'].includes(sort)) {\r\n            iconClass = 'fa-solid fa-pencil';\r\n        } else if (['monthlyCommentCount', 'commentCount'].includes(sort)) {\r\n            iconClass = 'fa-regular fa-comment';\r\n        } else if (['lotteryCount'].includes(sort)) {\r\n            iconClass = 'fa-solid fa-gift';\r\n        }\r\n        return (\r\n            <a href={userProfileLink}>\r\n                {avatarWithFrame?avatarWithFrame(user):avatar(user)}\r\n                <div className=\"LeaderboardListItem-username\">\r\n                    <div>\r\n                        {usernameWithColor?usernameWithColor(user):username(user)}\r\n                    </div>\r\n                </div>\r\n                <span\r\n                    className=\"LeaderboardListItem-count\"\r\n                    title=\"\"\r\n                    aria-label={`${points} Points`}\r\n                    data-original-title={`${points} Points`}\r\n                >\r\n                 {icon(iconClass)}\r\n                 {points}\r\n                </span>\r\n                <span className={`LeaderboardListItem-position ${positionClass}`}>{displayPosition}</span>\r\n            </a>\r\n        );\r\n    }\r\n}\r\n","import Component from 'flarum/common/Component';\r\nimport UserCard from 'flarum/forum/components/UserCard';\r\nimport SmallUserCard from './SmallUserCard';\r\nimport LeaderBoardUserCard from './LeaderBoardUserCard';\r\n\r\nexport default class LeaderBoardListItem extends Component {\r\n  view(vnode) {\r\n    const { user, useSmallCards, position,params } = this.attrs;\r\n\r\n    const attributes = {\r\n      user,\r\n      position,\r\n      params,\r\n      className: `UserCard--directory${useSmallCards ? ' UserCard--small' : ''}`,\r\n      controlsButtonClassName: 'Button Button--icon Button--flat',\r\n    };\r\n\r\n    return <div className=\"LeaderboardListItem\">{position>3 ? SmallUserCard.component(attributes) : LeaderBoardUserCard.component(attributes)}</div>;\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport Component from 'flarum/common/Component';\r\nimport Button from 'flarum/common/components/Button';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport Placeholder from 'flarum/common/components/Placeholder';\r\nimport LeaderBoardListItem from './LeaderBoardListItem';\r\n\r\nexport default class LeaderBoardList extends Component {\r\n    view() {\r\n        const { state } = this.attrs;\r\n        const params = state.getParams();\r\n        const useSmallCards = app.forum.attribute('leaderBoardSmallCards');\r\n        let loading;\r\n        if (state.isLoading()) {\r\n            loading = LoadingIndicator.component();\r\n        } else if (state.moreResults) {\r\n            loading = Button.component(\r\n                {\r\n                    className: 'Button',\r\n                    onclick: state.loadMore.bind(state),\r\n                },\r\n                app.translator.trans('nodeloc-leaderboard.forum.page.load_more_button')\r\n            );\r\n        }\r\n\r\n        if (state.empty()) {\r\n            const text = app.translator.trans('nodeloc-leaderboard.forum.page.empty_text');\r\n            return <div className=\"DiscussionList\">{Placeholder.component({ text })}</div>;\r\n        }\r\n\r\n        const podiumUsers = state.users.slice(0, 3);\r\n        const remainingUsers = state.users.slice(3);\r\n        // 交换前两名的位置\r\n        if (podiumUsers.length >= 2) {\r\n            [podiumUsers[0], podiumUsers[1]] = [podiumUsers[1], podiumUsers[0]];\r\n        }\r\n        return (\r\n            <div\r\n                className={\r\n                    'LeaderBoardList' +\r\n                    (state.isSearchResults() ? ' LeaderBoardList--searchResults' : '') +\r\n                    (useSmallCards ? ' LeaderBoardList--small-cards' : '')\r\n                }\r\n            >\r\n                <ul className=\"LeaderboardPodium\">\r\n                    {podiumUsers.map((user, index) => {\r\n                        return(\r\n                        <li key={user.id()} data-id={user.id()} className=\"LeaderboardPodium-item\">\r\n                            {LeaderBoardListItem.component({\r\n                                user,\r\n                                params,\r\n                                useSmallCards,\r\n                                position: index + 1,\r\n                                isPodium: true,\r\n                            })}\r\n                        </li>\r\n                        );\r\n                    })}\r\n                </ul>\r\n                <ul className=\"LeaderboardItemList\">\r\n                    {remainingUsers.map((user, index) => {\r\n                        return (<li key={user.id()} data-id={user.id()} className=\"LeaderboardItemList-item\">\r\n                            {LeaderBoardListItem.component({\r\n                                user,\r\n                                params,\r\n                                useSmallCards,\r\n                                position: index + 4,\r\n                                isPodium: false,\r\n                            })}\r\n                        </li>);\r\n                })}\r\n                </ul>\r\n                <div className=\"LeaderBoardList-loadMore\">{loading}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","/**\n * The sort options.\n * We use a class and not just a POJO/function because we want extensions to be able to extend it\n */\nexport default class SortMap {\n  sortMap() {\n    return {\n      money       : '-money',\n      lotteryCount     : '-lotteryCount',\n      bestAnswerCount  : '-bestAnswerCount',\n      lastCheckinMoney    : '-lastCheckinMoney',\n      monthlyDiscussionCount       : '-monthlyDiscussionCount',\n      monthlyCommentCount: '-monthlyCommentCount',\n      discussionCount   : '-discussionCount',\n      commentCount     : '-commentCount',\n    };\n  }\n}\n","/**\r\n * Based on Flarum's DiscussionListState\r\n */\r\nimport SortMap from '../../common/utils/SortMap';\r\n\r\nexport default class LeaderBoardState {\r\n  constructor(params = {}, app = window.app) {\r\n    this.params = params;\r\n\r\n    this.app = app;\r\n\r\n    this.users = [];\r\n\r\n    this.moreResults = false;\r\n\r\n    this.loading = false;\r\n\r\n    this.qBuilder = {};\r\n  }\r\n\r\n  requestParams() {\r\n    const params = { include: [], filter: {} };\r\n\r\n    const sortKey = this.params.sort || app.forum.attribute('leaderBoardDefaultSort');\r\n\r\n    // sort might be set to null if no sort params has been passed\r\n    params.sort = this.sortMap()[sortKey];\r\n\r\n      if (sortKey === 'lastCheckinMoney') {\r\n          // Add filter condition for last_checkin_time being today\r\n          const today = new Date().toISOString().split('T')[0]; // Get today's date in YYYY-MM-DD format\r\n          params.filter.q = `last_checkin_time:>${today}`;\r\n      }\r\n\r\n    return params;\r\n  }\r\n\r\n  sortMap() {\r\n    return {\r\n      default: '',\r\n      ...new SortMap().sortMap(),\r\n    };\r\n  }\r\n\r\n  getParams() {\r\n    return this.params;\r\n  }\r\n\r\n  clear() {\r\n    this.users = [];\r\n    m.redraw();\r\n  }\r\n\r\n  refreshParams(newParams) {\r\n    if (!this.hasUsers() || Object.keys(newParams).some((key) => this.getParams()[key] !== newParams[key])) {\r\n      const q = '';\r\n      this.params = newParams;\r\n\r\n      if (newParams.qBuilder) {\r\n        Object.assign(this.qBuilder, newParams.qBuilder || {});\r\n        this.params.q = Object.values(this.qBuilder).join(' ').trim();\r\n      }\r\n\r\n      if (!this.params.q && q) {\r\n        this.params.q = q;\r\n      }\r\n\r\n      this.refresh();\r\n    }\r\n  }\r\n\r\n  refresh() {\r\n    this.loading = true;\r\n\r\n    this.clear();\r\n\r\n    return this.loadResults().then(\r\n      (results) => {\r\n        this.users = [];\r\n        this.parseResults(results);\r\n      },\r\n      () => {\r\n        this.loading = false;\r\n        m.redraw();\r\n      }\r\n    );\r\n  }\r\n\r\n  loadResults(offset) {\r\n    const preloadedUsers = this.app.preloadedApiDocument();\r\n\r\n    if (preloadedUsers) {\r\n      return Promise.resolve(preloadedUsers);\r\n    }\r\n\r\n    const params = this.requestParams();\r\n    params.page = { offset };\r\n    params.include = params.include.join(',');\r\n\r\n    return this.app.store.find('users', params);\r\n  }\r\n\r\n  loadMore() {\r\n    this.loading = true;\r\n\r\n    this.loadResults(this.users.length).then(this.parseResults.bind(this));\r\n  }\r\n\r\n  parseResults(results) {\r\n    this.users.push(...results);\r\n\r\n    this.loading = false;\r\n    this.moreResults = !!results.payload.links && !!results.payload.links.next;\r\n\r\n    m.redraw();\r\n\r\n    return results;\r\n  }\r\n\r\n  hasUsers() {\r\n    return this.users.length > 0;\r\n  }\r\n\r\n  isLoading() {\r\n    return this.loading;\r\n  }\r\n\r\n  isSearchResults() {\r\n    return !!this.params.q;\r\n  }\r\n\r\n  empty() {\r\n    return !this.hasUsers() && !this.isLoading();\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport Page from 'flarum/common/components/Page';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport listItems from 'flarum/common/helpers/listItems';\r\nimport IndexPage from 'flarum/forum/components/IndexPage';\r\nimport Select from 'flarum/common/components/Select';\r\nimport Button from 'flarum/common/components/Button';\r\nimport LinkButton from 'flarum/common/components/LinkButton';\r\nimport SelectDropdown from 'flarum/common/components/SelectDropdown';\r\nimport extractText from 'flarum/common/utils/extractText';\r\nimport LeaderBoardList from './LeaderBoardList';\r\nimport LeaderBoardState from '../states/LeaderBoardState';\r\n\r\n\r\n/**\r\n * This page re-uses Flarum's IndexPage CSS classes\r\n */\r\nexport default class LeaderBoardPage extends Page {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.state = new LeaderBoardState({});\r\n    this.state.refreshParams(app.search.params());\r\n\r\n    this.bodyClass = 'Leader--Board';\r\n\r\n    let idSegments = [];\r\n    if (this.params().q) {\r\n      Array.from(this.params().q.matchAll(/group:([\\d,]+)/g)).forEach((match) => {\r\n        idSegments.push(match[1]);\r\n      });\r\n    }\r\n\r\n    app.history.push('leaderboard', app.translator.trans('nodeloc-leaderboard.forum.header.back_to_leader_board_tooltip'));\r\n  }\r\n\r\n  oncreate(vnode) {\r\n    super.oncreate(vnode);\r\n\r\n    app.setTitle(extractText(app.translator.trans('nodeloc-leaderboard.forum.page.nav')));\r\n  }\r\n\r\n  view() {\r\n    return (\r\n      <div className=\"IndexPage\">\r\n        {IndexPage.prototype.hero()}\r\n        <div className=\"container\">\r\n          <div className=\"sideNavContainer\">\r\n            <nav className=\"IndexPage-nav sideNav\">\r\n              <ul>{listItems(this.sidebarItems().toArray())}</ul>\r\n            </nav>\r\n            <div className=\"IndexPage-results sideNavOffset\">\r\n              <div className=\"IndexPage-toolbar\">\r\n                <ul className=\"IndexPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\r\n                <ul className=\"IndexPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\r\n              </div>\r\n              <LeaderBoardList state={this.state} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Our own sidebar. Re-uses Index.sidebarItems as the base\r\n   * Elements added here will only show up on the user directory page\r\n   *\r\n   * @return {ItemList}\r\n   */\r\n  sidebarItems() {\r\n    const items = IndexPage.prototype.sidebarItems();\r\n\r\n    items.setContent(\r\n      'nav',\r\n      SelectDropdown.component(\r\n        {\r\n          buttonClassName: 'Button',\r\n          className: 'App-titleControl',\r\n        },\r\n        this.navItems().toArray()\r\n      )\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  /**\r\n   * Our own sidebar navigation. Re-uses Index.navItems as the base\r\n   * Elements added here will only show up on the user directory page\r\n   *\r\n   * @return {ItemList}\r\n   */\r\n  navItems() {\r\n    const items = IndexPage.prototype.navItems();\r\n    const params = this.stickyParams();\r\n\r\n    items.add(\r\n      'nodeloc-leaderboard',\r\n      LinkButton.component(\r\n        {\r\n          href: app.route('nodeloc_leaderboard', params),\r\n          icon: 'fas fa-sort-amount-up',\r\n        },\r\n        app.translator.trans('nodeloc-leaderboard.forum.page.nav')\r\n      ),\r\n      85\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  viewItems() {\r\n    const items = new ItemList();\r\n    const sortMap = this.state.sortMap();\r\n\r\n    const sortOptions = {};\r\n    for (const i in sortMap) {\r\n      sortOptions[i] = app.translator.trans('nodeloc-leaderboard.lib.sort.' + i);\r\n    }\r\n\r\n    items.add(\r\n      'sort',\r\n      Select.component({\r\n        options: sortOptions,\r\n        value: this.state.getParams().sort || app.forum.attribute('leaderBoardDefaultSort'),\r\n        onchange: this.changeParams.bind(this),\r\n      }),\r\n      100\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  actionItems() {\r\n    const items = new ItemList();\r\n\r\n    items.add(\r\n      'refresh',\r\n      Button.component({\r\n        title: app.translator.trans('nodeloc-leaderboard.forum.page.refresh_tooltip'),\r\n        icon: 'fas fa-sync',\r\n        className: 'Button Button--icon',\r\n        onclick: () => {\r\n          this.state.refresh();\r\n          if (app.session.user) {\r\n            app.store.find('users', app.session.user.id());\r\n            m.redraw();\r\n          }\r\n        },\r\n      })\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  /**\r\n   * Redirect to the index page using the given sort parameter.\r\n   *\r\n   * @param {String} sort\r\n   */\r\n  changeParams(sort) {\r\n    const params = this.params();\r\n\r\n    if (sort === app.forum.attribute('leaderBoardDefaultSort')) {\r\n      delete params.sort;\r\n    } else {\r\n      params.sort = sort;\r\n    }\r\n\r\n    this.state.refreshParams(params);\r\n\r\n    const routeParams = { ...params };\r\n    delete routeParams.qBuilder;\r\n\r\n    m.route.set(app.route('nodeloc_leaderboard', routeParams));\r\n  }\r\n\r\n  stickyParams() {\r\n    return {\r\n      sort: m.route.param('sort'),\r\n      q: m.route.param('q'),\r\n    };\r\n  }\r\n\r\n  params() {\r\n    return this.stickyParams();\r\n  }\r\n}\r\n","import Button from 'flarum/common/components/Button';\r\nimport icon from 'flarum/common/helpers/icon';\r\n\r\nexport default class CheckableButton extends Button {\r\n  /**\r\n   * Get the template for the button's content.\r\n   *\r\n   * @return {*}\r\n   * @protected\r\n   */\r\n  getButtonContent(children) {\r\n    const prev = super.getButtonContent(children);\r\n\r\n    if (this.attrs.checked) prev.push(icon('fas fa-check', { className: 'Button-icon ButtonCheck' }));\r\n\r\n    return prev;\r\n  }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\r\n\r\n/**\r\n * Special model used only client-side to hold a free text search value in the search field\r\n */\r\nexport default class Text extends Model {\r\n  text = Model.attribute('text');\r\n}\r\n","import CheckableButton from './CheckableButton';\r\nimport SmallUserCard from './SmallUserCard';\r\nimport LeaderBoardList from './LeaderBoardList';\r\nimport LeaderBoardListItem from './LeaderBoardListItem';\r\nimport LeaderBoardPage from './LeaderBoardPage';\r\nimport LeaderBoardUserCard from './LeaderBoardUserCard';\r\n\r\nexport const components = {\r\n  CheckableButton,\r\n  SmallUserCard,\r\n  LeaderBoardList,\r\n  LeaderBoardListItem,\r\n  LeaderBoardPage,\r\n  LeaderBoardUserCard,\r\n};\r\n","import AbstractType from './AbstractType';\r\n\r\nexport const searchTypes = {\r\n  AbstractType,\r\n};\r\n","/**\r\n * @abstract\r\n */\r\nexport default class AbstractType {\r\n  constructor() {\r\n    this.suggestions = [];\r\n    this.loading = false;\r\n  }\r\n\r\n  /**\r\n   * The `type` property of the Models used in suggestions and applied filters for this type\r\n   * @return {String}\r\n   */\r\n  resourceType() {\r\n    //\r\n  }\r\n\r\n  /**\r\n   * Executed when the search query changes\r\n   * The method should update this.suggestions with the new results\r\n   * If asynchronous loading is used, this.loading should be set to true during the process\r\n   * @param {String} query\r\n   */\r\n  search(query) {\r\n    //\r\n  }\r\n\r\n  /**\r\n   * Renders the \"kind\" label next to the value indicating what kind of information that result is\r\n   * Should probably just be a translated text\r\n   * @param {Model} resource\r\n   * @return {vnode}\r\n   */\r\n  renderKind(resource) {\r\n    //\r\n  }\r\n\r\n  /**\r\n   * Renders the Label containing the suggestion's value\r\n   * Should be a vdom template using the .LeaderBoardSearchLabel class or similar\r\n   * @param {Model} resource\r\n   * @return {vnode}\r\n   */\r\n  renderLabel(resource) {\r\n    //\r\n  }\r\n\r\n  /**\r\n   * Applies a filter on a params object to use in the page request\r\n   * @param {Object} params Object. Might or might not contain a `q` property or `sort` property. In the future, `filters` object might be supported\r\n   * @param {Model} resource\r\n   */\r\n  applyFilter(params, resource) {\r\n    //\r\n  }\r\n\r\n  /**\r\n   * Used to populate the search field on page load with values from the querystring\r\n   * A promise must be returned, and the UI will auto-update once the promise returns\r\n   * @param {Object} params Object with a `q` and `sort` property. `filters` might be supported in the future\r\n   * @return {Promise<Model[]>}\r\n   */\r\n  initializeFromParams(params) {\r\n    //\r\n  }\r\n}\r\n","import { extend } from 'flarum/common/extend';\r\nimport app from 'flarum/forum/app';\r\nimport UsersSearchSource from 'flarum/common/components/UsersSearchSource';\r\nimport LinkButton from 'flarum/common/components/LinkButton';\r\nimport IndexPage from 'flarum/forum/components/IndexPage';\r\nimport CommentPost from 'flarum/forum/components/CommentPost';\r\nimport LeaderBoardPage from './components/LeaderBoardPage';\r\nimport LeaderBoardList from './components/LeaderBoardList';\r\nimport LeaderBoardListItem from './components/LeaderBoardListItem';\r\nimport LeaderBoardState from './states/LeaderBoardState';\r\nimport SortMap from '../common/utils/SortMap';\r\nimport CheckableButton from './components/CheckableButton';\r\nimport Text from './models/Text';\r\n\r\n// Allow other extensions to extend the page\r\nexport { LeaderBoardPage, LeaderBoardList, LeaderBoardListItem, LeaderBoardState, SortMap, CheckableButton };\r\n\r\napp.initializers.add('nodeloc-leaderboard', (app) => {\r\n  app.routes.nodeloc_leaderboard = {\r\n    path: '/leaderboard',\r\n    component: LeaderBoardPage,\r\n  };\r\n\r\n  app.store.models['nodeloc-leaderboard-text'] = Text;\r\n\r\n  extend(IndexPage.prototype, 'navItems', (items) => {\r\n    if (app.forum.attribute('canSeeLeaderBoardLink')) {\r\n      items.add(\r\n        'nodeloc-leaderboard',\r\n        LinkButton.component(\r\n          {\r\n            href: app.route('nodeloc_leaderboard'),\r\n            icon: 'fas fa-sort-amount-up',\r\n          },\r\n          app.translator.trans('nodeloc-leaderboard.forum.page.nav')\r\n        ),\r\n        85\r\n      );\r\n    }\r\n  });\r\n\r\n});\r\n\r\nexport * from './components';\r\nexport * from './searchTypes';\r\n"],"names":["module","exports","flarum","extensions","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","core","compat","_extends","assign","bind","e","arguments","length","t","apply","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","create","constructor","SmallUserCard","_Component","view","avatarWithFrame","usernameWithColor","user","this","attrs","sort","params","userProfileLink","app","points","attribute","position","components","require","positionClass","iconClass","includes","m","href","className","avatar","username","title","icon","Component","LeaderBoardUserCard","displayPosition","LeaderBoardListItem","vnode","_this$attrs","useSmallCards","attributes","controlsButtonClassName","component","LeaderBoardList","loading","state","getParams","isLoading","LoadingIndicator","moreResults","Button","onclick","loadMore","trans","empty","text","Placeholder","podiumUsers","users","slice","remainingUsers","_ref","isSearchResults","map","index","id","isPodium","SortMap","sortMap","money","lotteryCount","bestAnswerCount","lastCheckinMoney","monthlyDiscussionCount","monthlyCommentCount","discussionCount","commentCount","LeaderBoardState","window","qBuilder","_proto","requestParams","include","filter","sortKey","forum","today","Date","toISOString","split","q","default","clear","redraw","refreshParams","newParams","_this","hasUsers","keys","some","values","join","trim","refresh","_this2","loadResults","then","results","parseResults","offset","preloadedUsers","preloadedApiDocument","Promise","resolve","page","store","find","_this$users","push","payload","links","next","LeaderBoardPage","_Page","oninit","bodyClass","idSegments","Array","from","matchAll","forEach","match","oncreate","extractText","IndexPage","hero","listItems","sidebarItems","toArray","viewItems","actionItems","items","setContent","SelectDropdown","buttonClassName","navItems","stickyParams","add","LinkButton","ItemList","sortOptions","i","Select","options","onchange","changeParams","routeParams","route","set","param","Page","CheckableButton","_Button","getButtonContent","children","prev","checked","Text","_Model","_len","args","_key","concat","Model","searchTypes","AbstractType","suggestions","resourceType","search","query","renderKind","resource","renderLabel","applyFilter","initializeFromParams","routes","nodeloc_leaderboard","path","models","extend","translator"],"sourceRoot":""}
